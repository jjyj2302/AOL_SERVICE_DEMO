import React from 'react';
import {
  Box,
  Paper,
  Typography,
  Chip,
  List,
  ListItem,
  ListItemText,
  Divider,
} from '@mui/material';

export default function MalwareResult({ data }) {
  if (!data) return null;

  return (
    <Box>
      {/* Malware Identification */}
      <Paper sx={{ p: 3, mb: 3 }}>
        <Typography variant="h6" gutterBottom>
          π¦  μ•…μ„±μ½”λ“ μ‹λ³„
        </Typography>
        <Box sx={{ display: 'flex', gap: 1, mb: 2 }}>
          {data.malware_family && (
            <Chip label={`Family: ${data.malware_family}`} color="error" />
          )}
          {data.malware_type && (
            <Chip label={`Type: ${data.malware_type}`} variant="outlined" />
          )}
        </Box>
        <Typography variant="body1" sx={{ whiteSpace: 'pre-wrap' }}>
          {data.behavioral_profile}
        </Typography>
      </Paper>

      {/* Infrastructure Usage */}
      <Paper sx={{ p: 3, mb: 3 }}>
        <Typography variant="h6" gutterBottom>
          π μΈν”„λΌ μ‚¬μ© ν¨ν„΄
        </Typography>
        <Typography variant="body1" sx={{ mb: 2, whiteSpace: 'pre-wrap' }}>
          {data.infrastructure_usage_patterns}
        </Typography>
        {data.communication_mechanisms && data.communication_mechanisms.length > 0 && (
          <Box>
            <Typography variant="subtitle2" gutterBottom>
              ν†µμ‹  λ©”μ»¤λ‹μ¦:
            </Typography>
            <Box sx={{ display: 'flex', gap: 1, flexWrap: 'wrap' }}>
              {data.communication_mechanisms.map((mechanism, index) => (
                <Chip key={index} label={mechanism} size="small" />
              ))}
            </Box>
          </Box>
        )}
      </Paper>

      {/* Infrastructure Targets */}
      {data.infrastructure_targets && data.infrastructure_targets.length > 0 && (
        <Paper sx={{ p: 3, mb: 3 }}>
          <Typography variant="h6" gutterBottom>
            π― μΈν”„λΌ νƒ€κ²
          </Typography>
          <List>
            {data.infrastructure_targets.map((target, index) => (
              <React.Fragment key={index}>
                <ListItem>
                  <ListItemText
                    primary={
                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 0.5 }}>
                        <Chip label={target.target_type} size="small" color="warning" />
                        <Typography variant="body2" sx={{ fontFamily: 'monospace' }}>
                          {target.target}
                        </Typography>
                        <Chip
                          label={target.priority}
                          size="small"
                          color={
                            target.priority === 'HIGH' ? 'error' :
                            target.priority === 'MEDIUM' ? 'warning' : 'info'
                          }
                          variant="outlined"
                        />
                      </Box>
                    }
                    secondary={target.behavioral_context}
                  />
                </ListItem>
                {index < data.infrastructure_targets.length - 1 && <Divider />}
              </React.Fragment>
            ))}
          </List>
        </Paper>
      )}

      {/* Attack Chain */}
      <Paper sx={{ p: 3, mb: 3 }}>
        <Typography variant="h6" gutterBottom>
          π”— κ³µκ²© μ²΄μΈ λ¶„μ„
        </Typography>
        <Typography variant="body1" sx={{ mb: 2, whiteSpace: 'pre-wrap' }}>
          {data.attack_chain_analysis}
        </Typography>
        {data.payload_delivery_methods && data.payload_delivery_methods.length > 0 && (
          <Box>
            <Typography variant="subtitle2" gutterBottom>
              νμ΄λ΅λ“ μ „λ‹¬ λ°©λ²•:
            </Typography>
            <List dense>
              {data.payload_delivery_methods.map((method, index) => (
                <ListItem key={index}>
                  <ListItemText primary={`β€Ά ${method}`} />
                </ListItem>
              ))}
            </List>
          </Box>
        )}
      </Paper>

      {/* Parent-Child Relationships */}
      {data.parent_child_relationships && data.parent_child_relationships.length > 0 && (
        <Paper sx={{ p: 3, mb: 3 }}>
          <Typography variant="h6" gutterBottom>
            π‘¨β€π‘¦ λ¶€λ¨-μμ‹ κ΄€κ³„
          </Typography>
          <List>
            {data.parent_child_relationships.map((rel, index) => (
              <ListItem key={index}>
                <ListItemText primary={`β€Ά ${rel}`} />
              </ListItem>
            ))}
          </List>
        </Paper>
      )}

      {/* Correlation Recommendations */}
      {data.correlation_recommendations && data.correlation_recommendations.length > 0 && (
        <Paper sx={{ p: 3, mb: 3 }}>
          <Typography variant="h6" gutterBottom>
            π’΅ μƒκ΄€κ΄€κ³„ λ¶„μ„ κ¶μ¥μ‚¬ν•­
          </Typography>
          <List>
            {data.correlation_recommendations.map((rec, index) => (
              <ListItem key={index}>
                <ListItemText primary={`${index + 1}. ${rec}`} />
              </ListItem>
            ))}
          </List>
        </Paper>
      )}

      {/* Contextual Analysis */}
      <Paper sx={{ p: 3 }}>
        <Typography variant="h6" gutterBottom>
          π“ μ¶”κ°€ λ¶„μ„ μ μ•
        </Typography>
        <Typography variant="body1" sx={{ whiteSpace: 'pre-wrap' }}>
          {data.contextual_analysis}
        </Typography>
      </Paper>
    </Box>
  );
}
